# Crestron eControl CIP Intersystem Communication

## Port: 41794

## Proto: UDP (and SSL UDP)

## Amplification factor: ~15x

## Reflector count: ~5,500 (60% reduction in 3 months, well done)

---

Crestron 3-Series Control System suffers from default misconfiguration of allowing version and hostname information to be transmitted via the internet over connectionless UDP.

### Example Request / Response

- Request: 1 control code byte

  - > ~# echo -ne '\x14'|nc -u 98.184.205.58 41794 -w1|xxd -p|wc -c

- Response: 394 bytes (80% of data consists of 00 byte padding)

  - ASCII: `ï¿½MC3-WILSONMC3 [v1.502.3574.22740 (Oct 15 2018), #8BF20A92] @E-00107fd33c2a`
  - Raw Bytes: `150000000184000400004d43332d57494c534f4e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004d4333205b76312e3530322e333537342e323237343020284f63742031352032303138292c202338424632304139325d2040452d30303130376664333363326100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`

### Documentation

- https://www.crestron.com/Products/Control-Hardware-Software/Hardware/Control-Systems/MC3

### Mitigations

- Stop allowing default Internet access, restrict to LAN as default configuration (vendor issue)!
- Similar to other industrial control systems and household automation security issues.
- Response data is ALWAYS 394 bytes and consists of first-data-byte control character `\x15` with over 80% of the data in `\x00` byte padding:
  - 15000000018400040000(hostname)000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000(versioning)00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
